---
title: "STAT415 HW 5"
author: "Jaewon Choi"
date: "2024-02-23"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ISLR)
library(ISLR2)
library(FNN)
library(MASS)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
#1


#a)we need to find pi_hat, mu_hat, and variance for both 1 and -1 of QDA and LDA independently.
#for LDA
#p_hat_1 = 5/9, p_hat_-1 = 4/9, mu_hat_1 = (2+3+4+5-1)/5 = 2.6,
#mu_hat_-1 = -4/4 =-1, shared_variance = sum(xi - mu_k)^2/(n-K)
# K=2, n =9 summation = 31.2. 31.2/7 = 4.457
#for QDA
# same p_hat and mu_hat but have individual variance for each class
#sigma^2_hat_1 = 1/(5-1)*summation(xi -mu_k)^2 for only y = 1 and this equals 5.3
#sigma^2_hat_-1 = 3.33


#b)
#now that we all parts we just plug in
#LDA discriminant function
#delat_1(x) = x*(2.6/4.457)-(2.6^2/8.914)+log(5/9)
#delat_-1(x) = x*(-1/4.457)-(1/8.914)+log(4/9)
#QDA discriminant function
#delat_1(x) = -1/2*t(x-2.6)*sum(x-2.6)+log(5/9)
#delat_-1(x) = -1/2*t(x+1)*sum(x+1)+log(4/9)

#c) & d)
mat_data<-matrix(c(-3,-2,0,1,-1,2,3,4,5,-1,-1,-1,-1,1,1,1,1,1), nrow = 9)
train_data = as.data.frame(mat_data)
k<- matrix(c(-1.5,-1,0,1,0.5,1,2.5,5,-1,-1,-1,-1,1,1,1,1), nrow = 8)
test_data =as.data.frame(k)
lda_train <- lda(V2~V1, data = train_data)
train_pred <- predict(lda_train, train_data)$class
test_pred <- predict(lda_train, test_data)$class
train_err = mean(train_pred != train_data$V2)
test_err = mean(test_pred != test_data$V2)

qda_train <- qda(V2~V1, data = train_data)
train_pred_qda <- predict(qda_train, train_data)$class
test_pred_qda <- predict(qda_train, test_data)$class
train_err_qda = mean(train_pred_qda != train_data$V2)
test_err_qda = mean(test_pred_qda != test_data$V2)
#e) I would say that LDA is more suitable due to less complexity.
# I have gotten same values for both test and training error. Also 
# deriving quadratic discriminant function and calculating it has higher computational cost.
```

```{r}
#Q2
#a)
new_auto <- data.frame(Auto,mpg01 = ifelse(Auto$mpg > median(Auto$mpg), 1, 0))

#b) From scatter plot, displacement,horsepower,weight, and acceleration is related to mpg01. Boxplot suggested that origin along with the other 4 mentioned
# previously may be a valid predictors.
par(mfrow = c(2,4))

boxplot(new_auto$mpg01, new_auto$cylinders)
boxplot(new_auto$mpg01, new_auto$displacement)
boxplot(new_auto$mpg01, new_auto$horsepower)
boxplot(new_auto$mpg01, new_auto$weight)
boxplot(new_auto$mpg01, new_auto$acceleration)
boxplot(new_auto$mpg01, new_auto$year)
boxplot(new_auto$mpg01, new_auto$origin)

par(mfrow = c(2,4))

plot(new_auto$mpg01, new_auto$cylinders)
plot(new_auto$mpg01, new_auto$displacement)
plot(new_auto$mpg01, new_auto$horsepower)
plot(new_auto$mpg01, new_auto$weight)
plot(new_auto$mpg01, new_auto$acceleration)
plot(new_auto$mpg01, new_auto$year)
plot(new_auto$mpg01, new_auto$origin)

#c) 
traindata2 = sample(1:nrow(new_auto), size = floor(0.7*nrow(new_auto)))
autotrain = new_auto[traindata2, ]
autotest = new_auto[-traindata2, ]
#d)
autolda <- lda(mpg01~ displacement + horsepower + weight + acceleration + origin, data = new_auto)
auto_train_pred <- predict(autolda, autotrain)$class
auto_test_pred <-predict(autolda, autotest)$class
auto_train_erorr <- mean(auto_train_pred != new_auto$mpg01)
auto_test_error <- mean(auto_test_pred != new_auto$mpg01)
auto_test_error
#e)
autoqda <- qda(mpg01~ displacement + horsepower + weight + acceleration + origin, data = new_auto)
auto_train_pred2 <- predict(autoqda, autotrain)$class
auto_test_pred2 <-predict(autoqda, autotest)$class
auto_train_erorr2 <- mean(auto_train_pred2 != new_auto$mpg01)
auto_test_error2 <- mean(auto_test_pred2 != new_auto$mpg01)
auto_test_error2
#f)
autolog <- glm(mpg01~ displacement + horsepower + weight + acceleration + origin, data = new_auto, family = binomial)
pred_prob_test = predict(autolog, autotest, type = "response")
pred_class_test = ifelse(pred_prob_test == 1, "1", "0")
error_test = mean(pred_class_test != new_auto$mpg01)
error_test
#g)I'm confident that this should be the right way but I keep on getting an error saying that this k>n. I've checked all thre of new_auto autotest and auto train is larger than 100.
#K = c(1, 3, 5, 7 ,9)
#for(i in K){
#  auto_knn <- knn.reg(train = as.data.frame(autotrain[,c("displacement", #"horsepower","weight","acceleration","origin")]), y = new_auto$mpg01, test = #as.data.frame(autotest[,c("displacement", #"horsepower","weight","acceleration","origin")]), k = K)
#  test_errors[i] <- mean((auto_knn != new_auto$mpg01)**2)
#}
#true_K <- K[which.min(test_errors)]
#true_test_error <- test_errors[K]
#true_test_error


```
